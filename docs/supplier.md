# Работа с API поставщика

## Создание поставщика
Простейший способ создать поставщика - с помощью Django shell.

Обязательные параметры: **email** - имейл поставщика (string), **password** - пароль (string).

Пример создания поставщика:
```python
json manage.py shell
from contacts.models import User
User.objects.create_supplier(email='supplier@gmail.com', password='password')
```
При регистрации поставщика письмо с подтверждением имейла **не** отправляется.

## Авторизация
Авторизация подразумевает получение токена. Для получения токена отправьте отправьте **POST** запрос на API **/api/v1/auth/**.

Обязательные параметры: **username** - имейл пользователя (string), **password** - пароль (string).

Пример тела запроса:
```json
{
    "username": "supplier@gmail.com",
    "password": "password"
}
```

Пример успешного ответа:
```json
{
    "token": "ffb61b74e42a3e394830dff2702392b2393e6de9"
}
```

## Смена пароля
Для изменения пароля поставщика отправьте **PATCH** запрос на API **/api/v1/pwd/4/** с указанием идентификатора поставщика, а так же заголовка, содержащего токен поставщика.

Обязательные параметры: **password** - новый пароль (string).

Пример заголовка:
```
Authorization
Token ffb61b74e42a3e394830dff2702392b2393e6de9
```

Пример тела запроса:
```json
{
    "password": "!P@$$W0RD!"
}
```

Пример успешного ответа:
```json
{}
```

## Импорт товаров магазина из yaml файла
Для импорта товаров отправьте **POST** запрос на API **/api/v1/partner/import/** с указанием заголовка, содержащего токен поставщика.

Обязательные параметры: **filename** - абсолютный или относительный путь до файла с товарами на файловой системе (string).

Пример тела запроса:
```json
{
    "filename" : "shop1.yaml"
}
```

Пример заголовка:
```
Authorization
Token ffb61b74e42a3e394830dff2702392b2393e6de9
```

Пример успешного ответа:
```json
{
    "id": 1,
    "name": "Связной",
    "filename": "shop1.yaml"
}
```

## Получение списка состояний магазинов
Для получения списка текущих состояний подконтрольных магазинов отправьте **GET** запрос на API **/api/v1/partner/states/** с указанием заголовка, содержащего токен поставщика.

Пример заголовка:
```
Authorization
Token ffb61b74e42a3e394830dff2702392b2393e6de9
```

Пример успешного ответа:
```json
[
    {
        "id": 1,
        "name": "Связной",
        "is_closed": false
    }
]
```

## Изменения состояний магазина
Для изменения состояния какого-либо магазина отправьте **PUT** запрос на API **/api/v1/partner/states/1/** с указанием идентификатора магазина, а так же заголовка, содержащего токен поставщика.

Обязательные параметры: **is_closed** - указатель на состояние нового магазина (boolean).

Пример заголовка:
```
Authorization
Token ffb61b74e42a3e394830dff2702392b2393e6de9
```

Пример тела запроса:
```json
{
    "is_closed": false
}
```

Пример успешного ответа:
```json
{
    "id": 1,
    "name": "Связной",
    "is_closed": true
}
```

## Получение списка заказов
Для получения списка текущих заказов подконтрольных магазинов отправьте **GET** запрос на API **/api/v1/partner/orders/** с указанием заголовка, содержащего токен поставщика.

Пример заголовка:
```
Authorization
Token ffb61b74e42a3e394830dff2702392b2393e6de9
```

Пример успешного ответа:
```json
[
    {
        "id": 10,
        "total": 558000,
        "status": "new",
        "positions": [
            {
                "id": 1,
                "name": "Смартфон Apple iPhone XS Max 512GB (золотистый)",
                "price": 110000,
                "quantity": 5,
                "status": "new"
            },
        ]
    }
]
```
